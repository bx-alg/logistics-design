{"remainingRequest":"/Users/bx/logistics-design/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/bx/logistics-design/frontend/src/views/production/productionPlanDetail.vue?vue&type=style&index=0&id=9e5e2342&scoped=true&lang=css","dependencies":[{"path":"/Users/bx/logistics-design/frontend/src/views/production/productionPlanDetail.vue","mtime":1747197580347},{"path":"/Users/bx/logistics-design/frontend/node_modules/css-loader/dist/cjs.js","mtime":1747185535288},{"path":"/Users/bx/logistics-design/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1747185534140},{"path":"/Users/bx/logistics-design/frontend/node_modules/postcss-loader/src/index.js","mtime":1747185535100},{"path":"/Users/bx/logistics-design/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1747185535160},{"path":"/Users/bx/logistics-design/frontend/node_modules/vue-loader/lib/index.js","mtime":1747185534034}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5wYWdlLWhlYWRlciB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBtYXJnaW4tYm90dG9tOiAyMHB4OwogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgcGFkZGluZzogMTVweCAyMHB4OwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBib3gtc2hhZG93OiAwIDJweCAxMnB4IDAgcmdiYSgwLCAwLCAwLCAwLjEpOwp9Ci5oZWFkZXItdGl0bGUgewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKfQouaGVhZGVyLWFjdGlvbnMgewogIGRpc3BsYXk6IGZsZXg7CiAgZ2FwOiAxMHB4Owp9Ci5wbGFuLWluZm8tY2FyZCB7CiAgbWFyZ2luLWJvdHRvbTogMjBweDsKfQouaW5mby1pdGVtIHsKICBtYXJnaW4tYm90dG9tOiAxNXB4Owp9Ci5pbmZvLWxhYmVsIHsKICBmb250LXNpemU6IDE0cHg7CiAgY29sb3I6ICM5MDkzOTk7CiAgbWFyZ2luLWJvdHRvbTogNXB4Owp9Ci5pbmZvLXZhbHVlIHsKICBmb250LXNpemU6IDE0cHg7CiAgY29sb3I6ICMzMDMxMzM7Cn0KLnNlY3Rpb24tdGl0bGUgewogIGZvbnQtc2l6ZTogMTZweDsKICBmb250LXdlaWdodDogYm9sZDsKICBtYXJnaW4tYm90dG9tOiAxNXB4OwogIGNvbG9yOiAjMzAzMTMzOwp9Ci5wcm9ncmVzcy10aW1lbGluZSB7CiAgcGFkZGluZzogMjBweDsKfQo="},{"version":3,"sources":["productionPlanDetail.vue"],"names":[],"mappings":";AAqeA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"productionPlanDetail.vue","sourceRoot":"src/views/production","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"page-header\">\n      <div class=\"header-title\">\n        <el-page-header @back=\"goBack\" :content=\"'计划详情: ' + planDetail.planNo\" />\n      </div>\n      <div class=\"header-actions\">\n        <el-button v-if=\"planDetail.status === 0\" type=\"primary\" size=\"small\" @click=\"handleStart\">开始生产</el-button>\n        <el-button v-if=\"planDetail.status === 1\" type=\"success\" size=\"small\" @click=\"handleComplete\">完成生产</el-button>\n        <el-button v-if=\"planDetail.status === 0\" type=\"warning\" size=\"small\" @click=\"handleEdit\">编辑计划</el-button>\n        <el-button v-if=\"planDetail.status === 0\" type=\"danger\" size=\"small\" @click=\"handleCancel\">取消计划</el-button>\n      </div>\n    </div>\n\n    <el-card class=\"plan-info-card\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>基本信息</span>\n        <span style=\"float: right\" class=\"status-tag\">\n          <el-tag :type=\"getStatusType(planDetail.status)\">{{ getStatusName(planDetail.status) }}</el-tag>\n        </span>\n      </div>\n      <el-row :gutter=\"20\">\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">计划编号</div>\n            <div class=\"info-value\">{{ planDetail.planNo }}</div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">关联订单</div>\n            <div class=\"info-value\">\n              <el-link type=\"primary\" :underline=\"false\" @click=\"viewOrderDetail\">{{ planDetail.orderNo }}</el-link>\n            </div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">产品名称</div>\n            <div class=\"info-value\">{{ planDetail.productName }}</div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">计划数量</div>\n            <div class=\"info-value\">{{ planDetail.planQuantity }}</div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">实际数量</div>\n            <div class=\"info-value\">{{ planDetail.actualQuantity }}</div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">完成率</div>\n            <div class=\"info-value\">\n              <el-progress :percentage=\"calculateProgress\" :status=\"getProgressStatus\"></el-progress>\n            </div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">开始日期</div>\n            <div class=\"info-value\">{{ planDetail.startDate }}</div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">结束日期</div>\n            <div class=\"info-value\">{{ planDetail.endDate }}</div>\n          </div>\n        </el-col>\n        <el-col :span=\"8\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">优先级</div>\n            <div class=\"info-value\">\n              <el-tag size=\"medium\" :type=\"getPriorityType(planDetail.priority)\">{{ getPriorityName(planDetail.priority) }}</el-tag>\n            </div>\n          </div>\n        </el-col>\n        <el-col :span=\"24\">\n          <div class=\"info-item\">\n            <div class=\"info-label\">计划备注</div>\n            <div class=\"info-value\">{{ planDetail.remark || '无' }}</div>\n          </div>\n        </el-col>\n      </el-row>\n    </el-card>\n\n    <el-card style=\"margin-top: 20px;\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>生产进度跟踪</span>\n        <el-button \n          v-if=\"planDetail.status === 1\" \n          style=\"float: right; padding: 3px 0\" \n          type=\"text\"\n          @click=\"dialogVisible = true\"\n        >\n          更新进度\n        </el-button>\n      </div>\n      <div class=\"progress-timeline\">\n        <el-steps :active=\"activeStep\" finish-status=\"success\" align-center>\n          <el-step title=\"计划制定\" :description=\"planDetail.createTime || '-'\" />\n          <el-step title=\"开始生产\" :description=\"planDetail.startTime || '-'\" />\n          <el-step title=\"生产中\" :description=\"getProgressStepDesc\" />\n          <el-step title=\"生产完成\" :description=\"planDetail.completeTime || '-'\" />\n          <el-step title=\"产品入库\" :description=\"planDetail.storageTime || '-'\" />\n        </el-steps>\n      </div>\n\n      <div v-if=\"progressRecords.length > 0\" style=\"margin-top: 30px;\">\n        <div class=\"section-title\">进度更新记录</div>\n        <el-timeline>\n          <el-timeline-item\n            v-for=\"(record, index) in progressRecords\"\n            :key=\"index\"\n            :timestamp=\"record.updateTime\"\n            :type=\"index === 0 ? 'primary' : ''\"\n          >\n            <p>更新进度至 <strong>{{ record.progress }}%</strong></p>\n            <p v-if=\"record.operator\">操作人：{{ record.operator }}</p>\n            <p v-if=\"record.remark\">说明：{{ record.remark }}</p>\n          </el-timeline-item>\n        </el-timeline>\n      </div>\n    </el-card>\n\n    <el-card style=\"margin-top: 20px;\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>原材料消耗</span>\n      </div>\n      <el-table\n        :data=\"materialsList\"\n        border\n        style=\"width: 100%\"\n      >\n        <el-table-column prop=\"name\" label=\"材料名称\" />\n        <el-table-column prop=\"specification\" label=\"规格\" />\n        <el-table-column prop=\"unit\" label=\"单位\" width=\"100\" />\n        <el-table-column prop=\"planQuantity\" label=\"计划用量\" width=\"120\" />\n        <el-table-column prop=\"actualQuantity\" label=\"实际用量\" width=\"120\" />\n        <el-table-column prop=\"warehouseName\" label=\"出库仓库\" width=\"150\" />\n      </el-table>\n    </el-card>\n\n    <el-card style=\"margin-top: 20px;\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>生产工序</span>\n      </div>\n      <el-table\n        :data=\"processList\"\n        border\n        style=\"width: 100%\"\n      >\n        <el-table-column prop=\"seqNo\" label=\"序号\" width=\"80\" />\n        <el-table-column prop=\"processName\" label=\"工序名称\" />\n        <el-table-column prop=\"description\" label=\"工序描述\" show-overflow-tooltip />\n        <el-table-column prop=\"equipmentName\" label=\"设备名称\" width=\"150\" />\n        <el-table-column prop=\"planTime\" label=\"计划时长\" width=\"100\" />\n        <el-table-column prop=\"actualTime\" label=\"实际时长\" width=\"100\" />\n        <el-table-column label=\"状态\" width=\"120\">\n          <template slot-scope=\"scope\">\n            <el-tag :type=\"getProcessStatusType(scope.row.status)\">{{ getProcessStatusName(scope.row.status) }}</el-tag>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n\n    <!-- 更新进度对话框 -->\n    <el-dialog title=\"更新生产进度\" :visible.sync=\"dialogVisible\" width=\"500px\">\n      <el-form :model=\"progressForm\" :rules=\"progressRules\" ref=\"progressForm\" label-width=\"100px\">\n        <el-form-item label=\"当前进度\" prop=\"currentProgress\">\n          <el-progress :percentage=\"calculateProgress\" :status=\"getProgressStatus\"></el-progress>\n        </el-form-item>\n        <el-form-item label=\"新进度值\" prop=\"newProgress\">\n          <el-slider\n            v-model=\"progressForm.newProgress\"\n            :min=\"calculateProgress\"\n            :max=\"100\"\n            :step=\"5\"\n            show-input\n          />\n        </el-form-item>\n        <el-form-item label=\"实际生产数\" prop=\"actualQuantity\">\n          <el-input-number \n            v-model=\"progressForm.actualQuantity\" \n            :min=\"planDetail.actualQuantity || 0\" \n            :max=\"planDetail.planQuantity\" \n            :step=\"5\"\n          />\n        </el-form-item>\n        <el-form-item label=\"备注说明\" prop=\"remark\">\n          <el-input type=\"textarea\" v-model=\"progressForm.remark\" rows=\"3\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitProgress\" :loading=\"submitLoading\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ProductionPlanDetail',\n  data() {\n    return {\n      planId: null,\n      planDetail: {\n        id: null,\n        planNo: '',\n        orderNo: '',\n        productName: '',\n        planQuantity: 0,\n        actualQuantity: 0,\n        startDate: '',\n        endDate: '',\n        status: 0,\n        priority: 1,\n        remark: '',\n        createTime: '2023-10-01 09:00:00',\n        startTime: '2023-10-05 10:00:00',\n        completeTime: '',\n        storageTime: ''\n      },\n      dialogVisible: false,\n      progressForm: {\n        currentProgress: 0,\n        newProgress: 0,\n        actualQuantity: 0,\n        remark: ''\n      },\n      progressRules: {\n        newProgress: [\n          { required: true, message: '请设置新的进度值', trigger: 'change' }\n        ],\n        actualQuantity: [\n          { required: true, message: '请输入实际生产数量', trigger: 'blur' }\n        ]\n      },\n      submitLoading: false,\n      materialsList: [\n        { name: '铝合金', specification: 'AL6061', unit: 'kg', planQuantity: 100, actualQuantity: 97.5, warehouseName: '原料仓-A区' },\n        { name: '钢化玻璃', specification: '0.5mm', unit: '张', planQuantity: 550, actualQuantity: 550, warehouseName: '原料仓-B区' },\n        { name: '主板', specification: 'X2-1020', unit: '块', planQuantity: 500, actualQuantity: 500, warehouseName: '电子元件仓' },\n        { name: '电池', specification: '4000mAh', unit: '个', planQuantity: 520, actualQuantity: 510, warehouseName: '电子元件仓' },\n        { name: '包装材料', specification: '标准', unit: '套', planQuantity: 530, actualQuantity: 500, warehouseName: '包材仓' }\n      ],\n      processList: [\n        { seqNo: 1, processName: '原材料准备', description: '准备生产所需的所有原材料和零部件', equipmentName: '-', planTime: '2小时', actualTime: '1.5小时', status: 2 },\n        { seqNo: 2, processName: '组装主板', description: '组装主板和电子元件', equipmentName: '自动贴片机A', planTime: '4小时', actualTime: '4小时', status: 2 },\n        { seqNo: 3, processName: '屏幕组装', description: '屏幕和触控面板组装', equipmentName: '精密组装台B', planTime: '3小时', actualTime: '3.5小时', status: 2 },\n        { seqNo: 4, processName: '整机组装', description: '将所有组件组装成完整产品', equipmentName: '装配流水线C', planTime: '5小时', actualTime: '4.8小时', status: 2 },\n        { seqNo: 5, processName: '质量检测', description: '对产品进行全面质量检测', equipmentName: '自动检测设备D', planTime: '2小时', actualTime: '2小时', status: 1 },\n        { seqNo: 6, processName: '包装', description: '产品包装和贴标', equipmentName: '包装流水线E', planTime: '1.5小时', actualTime: '-', status: 0 }\n      ],\n      progressRecords: [\n        { updateTime: '2023-10-05 10:00:00', progress: 0, operator: '张工', remark: '开始生产' },\n        { updateTime: '2023-10-05 16:30:00', progress: 15, operator: '张工', remark: '完成原材料准备和部分组装' },\n        { updateTime: '2023-10-06 11:20:00', progress: 30, operator: '李工', remark: '完成主板组装' },\n        { updateTime: '2023-10-07 09:45:00', progress: 50, operator: '王工', remark: '完成屏幕组装' },\n        { updateTime: '2023-10-08 14:30:00', progress: 70, operator: '张工', remark: '完成整机组装，开始质量检测' }\n      ]\n    }\n  },\n  computed: {\n    calculateProgress() {\n      if (!this.planDetail.planQuantity) return 0\n      return Math.round((this.planDetail.actualQuantity / this.planDetail.planQuantity) * 100)\n    },\n    getProgressStatus() {\n      if (this.calculateProgress === 100) {\n        return 'success'\n      } else if (this.calculateProgress >= 80) {\n        return 'warning'\n      }\n      return ''\n    },\n    activeStep() {\n      if (this.planDetail.status === 0) return 1\n      if (this.planDetail.status === 1) {\n        return this.calculateProgress < 50 ? 2 : 3\n      }\n      if (this.planDetail.status === 2) return 4\n      if (this.planDetail.storageTime) return 5\n      return 1\n    },\n    getProgressStepDesc() {\n      if (this.planDetail.status === 1) {\n        return `进度: ${this.calculateProgress}%`\n      }\n      return '-'\n    }\n  },\n  created() {\n    const id = this.$route.params.id\n    if (id && !isNaN(parseInt(id))) {\n      this.planId = parseInt(id)\n      this.getPlanDetail()\n    } else {\n      this.$message.error('无效的计划ID')\n      this.goBack()\n    }\n  },\n  methods: {\n    getPlanDetail() {\n      // 模拟请求后端API获取计划详情\n      setTimeout(() => {\n        // 模拟数据\n        this.planDetail = {\n          id: this.planId,\n          planNo: 'PP20231001001',\n          orderNo: 'DD20231001001',\n          productName: '智能手机A',\n          planQuantity: 500,\n          actualQuantity: 350,\n          startDate: '2023-10-05',\n          endDate: '2023-10-15',\n          status: 1,\n          priority: 2,\n          remark: '高优先级订单，需优先安排生产',\n          createTime: '2023-10-01 09:00:00',\n          startTime: '2023-10-05 10:00:00',\n          completeTime: '',\n          storageTime: ''\n        }\n        \n        // 初始化进度表单\n        this.progressForm.currentProgress = this.calculateProgress\n        this.progressForm.newProgress = this.calculateProgress\n        this.progressForm.actualQuantity = this.planDetail.actualQuantity\n      }, 500)\n    },\n    goBack() {\n      this.$router.push({ name: 'ProductionPlan' })\n    },\n    viewOrderDetail() {\n      this.$router.push({ \n        name: 'OrderDetail', \n        params: { id: 1 }  // 这里应该根据orderNo查询到对应的orderId\n      })\n    },\n    // 获取状态类型\n    getStatusType(status) {\n      const typeMap = {\n        0: 'primary',\n        1: 'success',\n        2: 'warning',\n        3: 'danger'\n      }\n      return typeMap[status] || 'info'\n    },\n    // 获取状态名称\n    getStatusName(status) {\n      const nameMap = {\n        0: '待生产',\n        1: '生产中',\n        2: '已完成',\n        3: '已取消'\n      }\n      return nameMap[status] || '未知'\n    },\n    // 获取优先级类型\n    getPriorityType(priority) {\n      const typeMap = {\n        0: 'info',\n        1: '',\n        2: 'warning',\n        3: 'danger'\n      }\n      return typeMap[priority] || ''\n    },\n    // 获取优先级名称\n    getPriorityName(priority) {\n      const nameMap = {\n        0: '低',\n        1: '中',\n        2: '高',\n        3: '紧急'\n      }\n      return nameMap[priority] || '未知'\n    },\n    // 获取工序状态类型\n    getProcessStatusType(status) {\n      const typeMap = {\n        0: 'info',\n        1: 'primary',\n        2: 'success'\n      }\n      return typeMap[status] || 'info'\n    },\n    // 获取工序状态名称\n    getProcessStatusName(status) {\n      const nameMap = {\n        0: '待开始',\n        1: '进行中',\n        2: '已完成'\n      }\n      return nameMap[status] || '未知'\n    },\n    // 开始生产\n    handleStart() {\n      this.$confirm('确认开始生产该计划?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        // 模拟请求\n        this.planDetail.status = 1\n        this.planDetail.startTime = new Date().toLocaleString()\n        this.$message.success('已开始生产')\n      }).catch(() => {})\n    },\n    // 完成生产\n    handleComplete() {\n      this.$confirm('确认完成该生产计划?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        // 模拟请求\n        this.planDetail.status = 2\n        this.planDetail.actualQuantity = this.planDetail.planQuantity\n        this.planDetail.completeTime = new Date().toLocaleString()\n        this.$message.success('生产计划已完成')\n      }).catch(() => {})\n    },\n    // 编辑计划\n    handleEdit() {\n      this.$message.info('编辑功能待实现')\n    },\n    // 取消计划\n    handleCancel() {\n      this.$confirm('确认取消该生产计划?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        // 模拟请求\n        this.planDetail.status = 3\n        this.$message.success('生产计划已取消')\n      }).catch(() => {})\n    },\n    // 提交进度更新\n    submitProgress() {\n      this.$refs.progressForm.validate(valid => {\n        if (!valid) return\n        \n        this.submitLoading = true\n        \n        // 模拟提交请求\n        setTimeout(() => {\n          // 更新计划详情\n          this.planDetail.actualQuantity = this.progressForm.actualQuantity\n          \n          // 添加进度记录\n          const now = new Date().toLocaleString()\n          this.progressRecords.unshift({\n            updateTime: now,\n            progress: this.progressForm.newProgress,\n            operator: '当前用户',\n            remark: this.progressForm.remark || '常规进度更新'\n          })\n          \n          // 如果进度达到100%，自动完成\n          if (this.progressForm.newProgress === 100) {\n            this.planDetail.status = 2\n            this.planDetail.completeTime = now\n          }\n          \n          this.$message.success('进度更新成功')\n          this.dialogVisible = false\n          this.submitLoading = false\n        }, 1000)\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  background-color: #fff;\n  padding: 15px 20px;\n  border-radius: 4px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n}\n.header-title {\n  display: flex;\n  align-items: center;\n}\n.header-actions {\n  display: flex;\n  gap: 10px;\n}\n.plan-info-card {\n  margin-bottom: 20px;\n}\n.info-item {\n  margin-bottom: 15px;\n}\n.info-label {\n  font-size: 14px;\n  color: #909399;\n  margin-bottom: 5px;\n}\n.info-value {\n  font-size: 14px;\n  color: #303133;\n}\n.section-title {\n  font-size: 16px;\n  font-weight: bold;\n  margin-bottom: 15px;\n  color: #303133;\n}\n.progress-timeline {\n  padding: 20px;\n}\n</style> "]}]}