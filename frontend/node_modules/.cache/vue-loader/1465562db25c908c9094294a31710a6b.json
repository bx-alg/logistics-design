{"remainingRequest":"/Users/bx/logistics-design/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/bx/logistics-design/frontend/src/views/order/forecast.vue?vue&type=style&index=0&id=7f3ee236&scoped=true&lang=css","dependencies":[{"path":"/Users/bx/logistics-design/frontend/src/views/order/forecast.vue","mtime":1747999544416},{"path":"/Users/bx/logistics-design/frontend/node_modules/css-loader/dist/cjs.js","mtime":1747185535288},{"path":"/Users/bx/logistics-design/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1747185534140},{"path":"/Users/bx/logistics-design/frontend/node_modules/postcss-loader/src/index.js","mtime":1747185535100},{"path":"/Users/bx/logistics-design/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1747185535160},{"path":"/Users/bx/logistics-design/frontend/node_modules/vue-loader/lib/index.js","mtime":1747185534034}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5maWx0ZXItY29udGFpbmVyIHsKICBtYXJnaW4tYm90dG9tOiAyMHB4Owp9Ci5maWx0ZXItaXRlbS1jb250YWluZXIgewogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC13cmFwOiB3cmFwOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7Cn0KLmZpbHRlci1pdGVtIHsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgbWFyZ2luLXJpZ2h0OiAzMHB4OwogIG1hcmdpbi1ib3R0b206IDEwcHg7Cn0KLmxhYmVsIHsKICBtYXJnaW4tcmlnaHQ6IDEwcHg7CiAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKfQouY2hhcnQtY29udGFpbmVyIHsKICBtYXJnaW4tdG9wOiAyMHB4Owp9Ci5hbmFseXNpcy1jb250YWluZXIgewogIGRpc3BsYXk6IGZsZXg7CiAgcGFkZGluZzogMjBweDsKfQouYW5hbHlzaXMtaXRlbSB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIG1hcmdpbi1yaWdodDogNDBweDsKfQouYW5hbHlzaXMtbGFiZWwgewogIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgZm9udC1zaXplOiAxNHB4OwogIGNvbG9yOiAjNjA2MjY2Owp9Ci5hbmFseXNpcy1zdGF0cyB7CiAgZmxleDogMTsKICBkaXNwbGF5OiBncmlkOwogIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDMsIDFmcik7CiAgZ2FwOiAyMHB4Owp9Ci5zdGF0LWl0ZW0gewogIHRleHQtYWxpZ246IGNlbnRlcjsKfQouc3RhdC1sYWJlbCB7CiAgZm9udC1zaXplOiAxNHB4OwogIGNvbG9yOiAjNjA2MjY2OwogIG1hcmdpbi1ib3R0b206IDVweDsKfQouc3RhdC12YWx1ZSB7CiAgZm9udC1zaXplOiAyMHB4OwogIGZvbnQtd2VpZ2h0OiBib2xkOwogIGNvbG9yOiAjMzAzMTMzOwp9Ci5zdGF0LXZhbHVlLnVwIHsKICBjb2xvcjogIzY3QzIzQTsKfQouc3RhdC12YWx1ZS5kb3duIHsKICBjb2xvcjogI0Y1NkM2QzsKfQouZ3Jvd3RoLXJhdGUgewogIGZvbnQtd2VpZ2h0OiBib2xkOwp9Ci5ncm93dGgtcmF0ZS5wb3NpdGl2ZSB7CiAgY29sb3I6ICM2N0MyM0E7Cn0KLmdyb3d0aC1yYXRlLm5lZ2F0aXZlIHsKICBjb2xvcjogI0Y1NkM2QzsKfQo="},{"version":3,"sources":["forecast.vue"],"names":[],"mappings":";AAihBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"forecast.vue","sourceRoot":"src/views/order","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card class=\"filter-container\">\n      <div slot=\"header\">\n        <span>销量预测</span>\n        <el-button style=\"float: right; margin-left: 10px;\" type=\"success\" icon=\"el-icon-download\" @click=\"exportData\">导出预测数据</el-button>\n      </div>\n      <div class=\"filter-item-container\">\n        <div class=\"filter-item\">\n          <span class=\"label\">产品类别：</span>\n          <el-cascader\n            v-model=\"filterForm.category\"\n            :options=\"categoryOptions\"\n            :props=\"{ checkStrictly: true }\"\n            clearable\n            placeholder=\"请选择产品类别\"\n            style=\"width: 220px\"\n          />\n        </div>\n        <div class=\"filter-item\">\n          <span class=\"label\">预测周期：</span>\n          <el-select v-model=\"filterForm.period\" placeholder=\"请选择\" style=\"width: 180px\">\n            <el-option v-for=\"item in periodOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\n          </el-select>\n        </div>\n        <div class=\"filter-item\">\n          <span class=\"label\">预测算法：</span>\n          <el-select v-model=\"filterForm.algorithm\" placeholder=\"请选择\" style=\"width: 180px\">\n            <el-option v-for=\"item in algorithmOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\n          </el-select>\n        </div>\n        <div class=\"filter-item\">\n          <span class=\"label\">置信区间：</span>\n          <el-select v-model=\"filterForm.confidence\" placeholder=\"请选择\" style=\"width: 140px\">\n            <el-option v-for=\"item in confidenceOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\n          </el-select>\n        </div>\n        <div class=\"filter-item\">\n          <span class=\"label\">历史数据：</span>\n          <el-date-picker\n            v-model=\"filterForm.dateRange\"\n            type=\"daterange\"\n            range-separator=\"至\"\n            start-placeholder=\"开始日期\"\n            end-placeholder=\"结束日期\"\n            :picker-options=\"pickerOptions\"\n            style=\"width: 320px\"\n          />\n        </div>\n      </div>\n      <div class=\"filter-item-container\" style=\"margin-top: 10px;\">\n        <el-button type=\"primary\" icon=\"el-icon-refresh\" @click=\"handleForecast\">生成预测</el-button>\n        <el-button type=\"info\" icon=\"el-icon-setting\" @click=\"showAdvancedSettings = true\">高级设置</el-button>\n      </div>\n    </el-card>\n\n    <div class=\"chart-container\" v-loading=\"loading\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"24\">\n          <el-card shadow=\"hover\">\n            <div slot=\"header\">\n              <span>销量预测图表</span>\n              <div style=\"float: right;\">\n                <el-radio-group v-model=\"chartType\" size=\"mini\" style=\"margin-right: 15px;\">\n                  <el-radio-button label=\"line\">折线图</el-radio-button>\n                  <el-radio-button label=\"bar\">柱状图</el-radio-button>\n                </el-radio-group>\n                <el-switch\n                  v-model=\"showConfidenceInterval\"\n                  active-text=\"显示置信区间\"\n                  inactive-text=\"\"\n                />\n              </div>\n            </div>\n            <div ref=\"forecastChart\" style=\"height: 400px;\"></div>\n          </el-card>\n        </el-col>\n      </el-row>\n\n      <el-row :gutter=\"20\" style=\"margin-top: 20px;\">\n        <el-col :span=\"12\">\n          <el-card shadow=\"hover\">\n            <div slot=\"header\">\n              <span>产品预测排行</span>\n              <el-select v-model=\"rankingType\" size=\"mini\" style=\"float: right; width: 120px\">\n                <el-option label=\"销量排名\" value=\"volume\" />\n                <el-option label=\"增长率排名\" value=\"growth\" />\n              </el-select>\n            </div>\n            <el-table :data=\"topProductsList\" border style=\"width: 100%\">\n              <el-table-column prop=\"rank\" label=\"排名\" width=\"80\" align=\"center\" />\n              <el-table-column prop=\"productName\" label=\"产品名称\" align=\"center\" />\n              <el-table-column prop=\"forecast\" label=\"预测销量\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  {{ scope.row.forecast.toLocaleString() }}\n                </template>\n              </el-table-column>\n              <el-table-column prop=\"growth\" label=\"增长率\" align=\"center\">\n                <template slot-scope=\"scope\">\n                  <span :class=\"['growth-rate', scope.row.growth >= 0 ? 'positive' : 'negative']\">\n                    {{ scope.row.growth >= 0 ? '+' : '' }}{{ scope.row.growth }}%\n                  </span>\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-card>\n        </el-col>\n        <el-col :span=\"12\">\n          <el-card shadow=\"hover\">\n            <div slot=\"header\">\n              <span>预测分析报告</span>\n            </div>\n            <div class=\"analysis-container\">\n              <div class=\"analysis-item\">\n                <div class=\"analysis-label\">预测准确率</div>\n                <el-progress type=\"circle\" :percentage=\"forecastAccuracy\" :color=\"accuracyColors\"></el-progress>\n              </div>\n              <div class=\"analysis-stats\">\n                <div class=\"stat-item\">\n                  <div class=\"stat-label\">平均误差率</div>\n                  <div class=\"stat-value\">{{ averageError }}%</div>\n                </div>\n                <div class=\"stat-item\">\n                  <div class=\"stat-label\">预测趋势</div>\n                  <div class=\"stat-value\" :class=\"trend.type\">{{ trend.text }}</div>\n                </div>\n                <div class=\"stat-item\">\n                  <div class=\"stat-label\">季节性指数</div>\n                  <div class=\"stat-value\">{{ seasonalityIndex }}</div>\n                </div>\n              </div>\n            </div>\n          </el-card>\n        </el-col>\n      </el-row>\n    </div>\n\n    <!-- 高级设置对话框 -->\n    <el-dialog title=\"预测高级设置\" :visible.sync=\"showAdvancedSettings\" width=\"600px\">\n      <el-form :model=\"advancedSettings\" label-width=\"140px\">\n        <el-form-item label=\"季节性周期\">\n          <el-input-number v-model=\"advancedSettings.seasonality\" :min=\"1\" :max=\"52\"></el-input-number>\n        </el-form-item>\n        <el-form-item label=\"趋势分解方法\">\n          <el-select v-model=\"advancedSettings.decomposition\" style=\"width: 100%\">\n            <el-option label=\"加法模型\" value=\"additive\" />\n            <el-option label=\"乘法模型\" value=\"multiplicative\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"异常值处理\">\n          <el-select v-model=\"advancedSettings.outlierMethod\" style=\"width: 100%\">\n            <el-option label=\"移动平均\" value=\"moving_average\" />\n            <el-option label=\"中位数替换\" value=\"median\" />\n            <el-option label=\"保持原值\" value=\"keep\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"预测步长\">\n          <el-input-number v-model=\"advancedSettings.forecastSteps\" :min=\"1\" :max=\"365\"></el-input-number>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\">\n        <el-button @click=\"showAdvancedSettings = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"handleAdvancedSettingsSave\">确定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport * as echarts from 'echarts'\nimport FileSaver from 'file-saver'\nimport XLSX from 'xlsx'\n\nexport default {\n  name: 'OrderForecast',\n  data() {\n    return {\n      loading: false,\n      filterForm: {\n        category: [],\n        period: 'month',\n        algorithm: 'arima',\n        confidence: 95,\n        dateRange: []\n      },\n      categoryOptions: [\n        {\n          value: 'electronics',\n          label: '电子产品',\n          children: [\n            { value: 'phone', label: '手机' },\n            { value: 'laptop', label: '笔记本' },\n            { value: 'tablet', label: '平板' }\n          ]\n        },\n        {\n          value: 'appliances',\n          label: '家用电器',\n          children: [\n            { value: 'tv', label: '电视' },\n            { value: 'fridge', label: '冰箱' },\n            { value: 'washer', label: '洗衣机' }\n          ]\n        }\n      ],\n      periodOptions: [\n        { label: '未来一周', value: 'week' },\n        { label: '未来一个月', value: 'month' },\n        { label: '未来一个季度', value: 'quarter' },\n        { label: '未来一年', value: 'year' }\n      ],\n      algorithmOptions: [\n        { label: 'ARIMA模型', value: 'arima' },\n        { label: '指数平滑法', value: 'exponential' },\n        { label: '季节性分解', value: 'seasonal' },\n        { label: '神经网络', value: 'neural' }\n      ],\n      confidenceOptions: [\n        { label: '90%', value: 90 },\n        { label: '95%', value: 95 },\n        { label: '99%', value: 99 }\n      ],\n      pickerOptions: {\n        shortcuts: [\n          {\n            text: '最近一周',\n            onClick(picker) {\n              const end = new Date()\n              const start = new Date()\n              start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\n              picker.$emit('pick', [start, end])\n            }\n          },\n          {\n            text: '最近一个月',\n            onClick(picker) {\n              const end = new Date()\n              const start = new Date()\n              start.setMonth(start.getMonth() - 1)\n              picker.$emit('pick', [start, end])\n            }\n          },\n          {\n            text: '最近三个月',\n            onClick(picker) {\n              const end = new Date()\n              const start = new Date()\n              start.setMonth(start.getMonth() - 3)\n              picker.$emit('pick', [start, end])\n            }\n          }\n        ]\n      },\n      chartType: 'line',\n      showConfidenceInterval: true,\n      rankingType: 'volume',\n      topProductsList: [],\n      forecastAccuracy: 85,\n      averageError: 8.5,\n      trend: {\n        type: 'up',\n        text: '上升趋势'\n      },\n      seasonalityIndex: 0.82,\n      showAdvancedSettings: false,\n      advancedSettings: {\n        seasonality: 12,\n        decomposition: 'multiplicative',\n        outlierMethod: 'moving_average',\n        forecastSteps: 30\n      },\n      charts: {\n        forecastChart: null\n      },\n      accuracyColors: [\n        {color: '#F56C6C', percentage: 60},\n        {color: '#E6A23C', percentage: 70},\n        {color: '#67C23A', percentage: 80},\n        {color: '#409EFF', percentage: 90}\n      ]\n    }\n  },\n  mounted() {\n    this.initCharts()\n    window.addEventListener('resize', this.resizeCharts)\n    this.generateMockData()\n  },\n  beforeDestroy() {\n    window.removeEventListener('resize', this.resizeCharts)\n    this.destroyCharts()\n  },\n  methods: {\n    initCharts() {\n      this.charts.forecastChart = echarts.init(this.$refs.forecastChart)\n      this.updateForecastChart()\n    },\n    generateMockData() {\n      // 生成模拟的产品排名数据\n      this.topProductsList = [\n        { rank: 1, productName: '智能手机A', forecast: 12500, growth: 15.3 },\n        { rank: 2, productName: '笔记本电脑B', forecast: 8600, growth: 8.2 },\n        { rank: 3, productName: '平板电脑C', forecast: 7200, growth: 5.7 },\n        { rank: 4, productName: '智能手表D', forecast: 5800, growth: 12.1 },\n        { rank: 5, productName: '智能音箱E', forecast: 4500, growth: 9.5 },\n        { rank: 6, productName: '耳机F', forecast: 3900, growth: -2.8 },\n        { rank: 7, productName: '显示器G', forecast: 3200, growth: 1.5 },\n        { rank: 8, productName: '键盘H', forecast: 2800, growth: -1.2 }\n      ]\n    },\n    updateForecastChart() {\n      const dates = []\n      const historicalData = []\n      const forecastData = []\n      const confidenceUpper = []\n      const confidenceLower = []\n      \n      // 生成日期和数据\n      const now = new Date()\n      let dateFormat = 'MM-dd'\n      let days = 30\n      \n      switch (this.filterForm.period) {\n        case 'week':\n          days = 7\n          dateFormat = 'MM-dd'\n          break\n        case 'month':\n          days = 30\n          dateFormat = 'MM-dd'\n          break\n        case 'quarter':\n          days = 90\n          dateFormat = 'MM-dd'\n          break\n        case 'year':\n          days = 365\n          dateFormat = 'yyyy-MM'\n          break\n      }\n      \n      // 生成历史数据和预测数据\n      for (let i = 30; i > 0; i--) {\n        const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000)\n        const baseValue = Math.floor(Math.random() * 500 + 500)\n        historicalData.push(baseValue)\n        \n        if (i <= days) {\n          dates.push(this.formatDate(date, dateFormat))\n        }\n      }\n      \n      // 生成预测数据和置信区间\n      for (let i = 1; i <= days; i++) {\n        const date = new Date(now.getTime() + i * 24 * 60 * 60 * 1000)\n        dates.push(this.formatDate(date, dateFormat))\n        \n        const baseValue = Math.floor(Math.random() * 200 + 600)\n        forecastData.push(baseValue)\n        \n        if (this.showConfidenceInterval) {\n          const interval = baseValue * 0.1\n          confidenceUpper.push(baseValue + interval)\n          confidenceLower.push(baseValue - interval)\n        }\n      }\n      \n      // 配置图表选项\n      const option = {\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross'\n          }\n        },\n        legend: {\n          data: ['历史销量', '预测销量'].concat(this.showConfidenceInterval ? ['置信区间'] : [])\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: {\n          type: 'category',\n          boundaryGap: this.chartType === 'bar',\n          data: dates,\n          axisLabel: {\n            rotate: 45\n          }\n        },\n        yAxis: {\n          type: 'value',\n          name: '销量'\n        },\n        series: [\n          {\n            name: '历史销量',\n            type: this.chartType,\n            data: historicalData.slice(-days),\n            itemStyle: {\n              color: '#409EFF'\n            }\n          },\n          {\n            name: '预测销量',\n            type: this.chartType,\n            data: forecastData,\n            itemStyle: {\n              color: '#67C23A'\n            }\n          }\n        ].concat(this.showConfidenceInterval ? [\n          {\n            name: '置信区间',\n            type: 'line',\n            data: confidenceUpper,\n            lineStyle: {\n              opacity: 0.3,\n              type: 'dashed'\n            },\n            areaStyle: {\n              opacity: 0.1\n            },\n            stack: 'confidence',\n            symbol: 'none'\n          },\n          {\n            name: '置信区间',\n            type: 'line',\n            data: confidenceLower,\n            lineStyle: {\n              opacity: 0.3,\n              type: 'dashed'\n            },\n            areaStyle: {\n              opacity: 0.1\n            },\n            stack: 'confidence',\n            symbol: 'none'\n          }\n        ] : [])\n      }\n      \n      this.charts.forecastChart.setOption(option)\n    },\n    formatDate(date, format) {\n      const year = date.getFullYear()\n      const month = date.getMonth() + 1\n      const day = date.getDate()\n      \n      if (format === 'yyyy-MM') {\n        return `${year}-${month < 10 ? '0' + month : month}`\n      }\n      \n      return `${month < 10 ? '0' + month : month}-${day < 10 ? '0' + day : day}`\n    },\n    handleForecast() {\n      this.loading = true\n      setTimeout(() => {\n        this.updateForecastChart()\n        this.generateMockData()\n        this.loading = false\n        this.$message.success('预测数据已更新')\n      }, 1500)\n    },\n    handleAdvancedSettingsSave() {\n      this.showAdvancedSettings = false\n      this.handleForecast()\n    },\n    exportData() {\n      const data = [\n        ['产品名称', '预测销量', '增长率'],\n        ...this.topProductsList.map(item => [\n          item.productName,\n          item.forecast,\n          `${item.growth}%`\n        ])\n      ]\n      \n      const ws = XLSX.utils.aoa_to_sheet(data)\n      const wb = XLSX.utils.book_new()\n      XLSX.utils.book_append_sheet(wb, ws, '销量预测数据')\n      \n      const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' })\n      const blob = new Blob([wbout], { type: 'application/octet-stream' })\n      FileSaver.saveAs(blob, `销量预测报告_${new Date().toLocaleDateString()}.xlsx`)\n    },\n    resizeCharts() {\n      for (const key in this.charts) {\n        if (this.charts[key]) {\n          this.charts[key].resize()\n        }\n      }\n    },\n    destroyCharts() {\n      for (const key in this.charts) {\n        if (this.charts[key]) {\n          this.charts[key].dispose()\n          this.charts[key] = null\n        }\n      }\n    }\n  },\n  watch: {\n    chartType() {\n      this.updateForecastChart()\n    },\n    showConfidenceInterval() {\n      this.updateForecastChart()\n    },\n    rankingType() {\n      // 根据排名类型重新排序\n      this.topProductsList.sort((a, b) => {\n        return this.rankingType === 'volume'\n          ? b.forecast - a.forecast\n          : b.growth - a.growth\n      })\n      \n      // 更新排名\n      this.topProductsList.forEach((item, index) => {\n        item.rank = index + 1\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n.filter-container {\n  margin-bottom: 20px;\n}\n.filter-item-container {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n}\n.filter-item {\n  display: flex;\n  align-items: center;\n  margin-right: 30px;\n  margin-bottom: 10px;\n}\n.label {\n  margin-right: 10px;\n  white-space: nowrap;\n}\n.chart-container {\n  margin-top: 20px;\n}\n.analysis-container {\n  display: flex;\n  padding: 20px;\n}\n.analysis-item {\n  text-align: center;\n  margin-right: 40px;\n}\n.analysis-label {\n  margin-bottom: 10px;\n  font-size: 14px;\n  color: #606266;\n}\n.analysis-stats {\n  flex: 1;\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 20px;\n}\n.stat-item {\n  text-align: center;\n}\n.stat-label {\n  font-size: 14px;\n  color: #606266;\n  margin-bottom: 5px;\n}\n.stat-value {\n  font-size: 20px;\n  font-weight: bold;\n  color: #303133;\n}\n.stat-value.up {\n  color: #67C23A;\n}\n.stat-value.down {\n  color: #F56C6C;\n}\n.growth-rate {\n  font-weight: bold;\n}\n.growth-rate.positive {\n  color: #67C23A;\n}\n.growth-rate.negative {\n  color: #F56C6C;\n}\n</style> "]}]}